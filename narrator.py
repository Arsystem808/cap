# -*- coding: utf-8 -*-
from __future__ import annotations
import random

def pick(arr, seed_key=""):
    random.seed(str(seed_key))
    return random.choice(arr)

def humanize(ticker: str, horizon: str, decision: dict) -> str:
    hz = {"ST":"–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ–∫","MID":"—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ–∫","LT":"–¥–æ–ª–≥–æ—Å—Ä–æ–∫"}[horizon]
    price = decision["price"]
    base, alt = decision["base"], decision["alt"]

    intros = {
        "ST": [
            "–í —Ç–∞–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –±–µ—Ä—É —Ç–æ–ª—å–∫–æ –æ—Ç –∫—Ä–∞—è –∏ –±–µ–∑ —Å—É–µ—Ç—ã.",
            "–°–µ–π—á–∞—Å –≤–∞–∂–Ω–µ–µ —Ç–æ—á–Ω–æ—Å—Ç—å, —á–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å.",
            "–ï—Å–ª–∏ —Ä—ã–Ω–æ–∫ —Ç—è–Ω–µ—Ç –±–µ–∑ –æ—Ç–¥—ã—Ö–∞, —á–∞—Å—Ç–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —Ä–µ–∑–∫–∏–º –≤–æ–∑–≤—Ä–∞—Ç–æ–º."
        ],
        "MID": [
            "–†—ã–Ω–æ–∫ –ø–µ—Ä–µ—à—ë–ª –≤ —Ñ–∞–∑—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–ª—ã ‚Äî –Ω–µ —Å–ø–µ—à–∏–º.",
            "–ü—Ä–µ–¥–ø–æ—á—Ç—É –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —É –æ–ø–æ—Ä–Ω–æ–π –∑–æ–Ω—ã.",
            "–°–µ–π—á–∞—Å –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç —Ç–µ—Ä–ø–µ–Ω–∏–µ –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞."
        ],
        "LT": [
            "–ü–æ–¥ –ø–æ—Ç–æ–ª–∫–æ–º –Ω–µ –ø–æ–∫—É–ø–∞—é ‚Äî –∂–¥—É, –≥–¥–µ –ø–µ—Ä–µ–≤–µ—Å –Ω–∞ –Ω–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ.",
            "–ü—É—Å—Ç—å —Ä—ã–Ω–æ–∫ –≤—ã–¥–æ—Ö–Ω–µ—Ç ‚Äî –≤—Å—Ç—Ä–µ—á—É –µ–≥–æ –Ω–∏–∂–µ, –≤ –≤—ã–≥–æ–¥–Ω–æ–º –∫–æ—Ä–∏–¥–æ—Ä–µ.",
            "–ó–¥–µ—Å—å –≤–∞–∂–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ç–æ—á–∫–∏, —á–µ–º —Ä–∞–Ω–Ω–∏–π –≤—Ö–æ–¥."
        ]
    }
    intro = pick(intros[horizon], seed_key=ticker+hz+str(price))

    def block(title, side):
        act = side["action"]
        if act == "WAIT":
            return f"{title}:\n‚Üí WAIT\n"
        txt = [f"{title}: {act}"]
        if side["entry"] is not None: txt.append(f"–≤—Ö–æ–¥: {side['entry']}")
        if side["tp1"] is not None:   txt.append(f"—Ü–µ–ª—å 1: {side['tp1']}")
        if side["tp2"] is not None:   txt.append(f"—Ü–µ–ª—å 2: {side['tp2']}")
        if side["sl"]  is not None:   txt.append(f"–∑–∞—â–∏—Ç–∞: {side['sl']}")
        return " | ".join(txt)

    headline = f"üìà {ticker} ‚Äî {hz}\n–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: {price}\n\n{intro}\n"
    body = block("‚úÖ –ü–ª–∞–Ω", base) + "\n" + block("üîÅ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞", alt)

    tails = [
        "–ï—Å–ª–∏ —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—Å—è ‚Äî —Ä–∞–±–æ—Ç–∞–µ–º; –µ—Å–ª–∏ –ª–æ–º–∞–µ—Ç—Å—è ‚Äî –≤—ã—Ö–æ–¥–∏–º –±–µ–∑ –∫–æ–ª–µ–±–∞–Ω–∏–π.",
        "–ù–µ —Å–ø–µ—à–∏–º: —Ä—ã–Ω–æ–∫ –¥–∞—Å—Ç —Ç–æ—á–∫—É ‚Äî –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –µ—ë –¥–æ–∂–¥–∞—Ç—å—Å—è.",
        "–ü–ª–∞–Ω –µ—Å—Ç—å, —Ç–µ–ø–µ—Ä—å –Ω–∞–±–ª—é–¥–∞–µ–º –∏ –¥–µ–π—Å—Ç–≤—É–µ–º –ø–æ —Ñ–∞–∫—Ç—É."
    ]
    tail = pick(tails, seed_key=hz+ticker)
    return f"{headline}\n{body}\n\n{tail}"
